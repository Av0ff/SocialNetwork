@using Microsoft.AspNetCore.Identity;
@using SocialMedia.Areas.Identity.Data;
@inject UserManager<User> _user
@inject PostRepo _post
@model ProfileModel

@{
	User user = await _user.FindByIdAsync(Model.UserId);
}

<section class="container-profile">
	<div class="user">
		<div class="form-group" style="display: flex; justify-content: center">
			@if (Model.Picture != null)
			{
				<img id="profilePicture" style="width: 200px; height: 200px; object-fit: fill" src="data:image/*;base64,@(Convert.ToBase64String(Model.Picture))" />
			}
			else
			{
				<img id="profilePicture" style="background-color: darkgrey; width: 200px; height: 200px;" src=".." />
			}
		</div>
		<h1 style="text-align: center">@user.UserName</h1>
		<h5 style="text-align: center">Status: @Model.Status</h5>
	</div>
	<div class="info">
		<h5>First Name: @Model.FirstName</h5>
		<h5>Last Name: @Model.LastName</h5>
		<h5>Birth: @Model.Birth</h5>
		<div class="btn">
			@{
				if (user.Id == _user.GetUserId(User))
				{
					<input type="button" value="Change" onclick="location.href='@Url.Action("UpdateProfile","Profile")'" />
				}
			}
		</div>
	</div>
	<div class="add-post">
		<partial name="_PostPartial.cshtml" model="new PostModel()"/>
	</div>
</section>
<section class="container-post">
	<div class="profile-links">

	</div>
	@if (_post.GetUserPosts(user.Profile.Id).Count() > 0)
	{
		foreach (var post in _post.GetUserPosts(user.Profile.Id))
		{
			<div class="profile-post">
				<p>@post.Image</p>
				<p>@post.Text</p>
				<input type="button" value="Change" onclick="location.href='@Url.Action("ChangePost","Profile", new {})'"/>
				<input type="button" value="Delete" onclick="location.href='@Url.Action("RemovePost","Profile", new { id = post.Id })'" />
			</div>
		}
	}
</section>
@*<hr />*@